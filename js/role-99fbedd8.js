import{d as e,r as l,o as a,i as t,j as o,f as u,h as s,w as d,D as r,K as i,k as n,C as c,l as v,b as m,g as p,L as h,B as f,E as w,J as _}from"./index-2d14b671.js";import{g as b,a as y,u as k}from"./role-57eb8529.js";import{f as N}from"./index-4742ef83.js";const C={class:"continer"},R=v("新增"),g=v("更新"),S=v("取消"),V=e({__name:"role-model",props:{treeList:null,status:null,showRole:null},emits:["addRole","cancel","updateRole"],setup(e,{emit:v}){const m=e,p=l(),h=l(),f={children:"children",label:"label"},w=l({roleName:"",isShow:0}),_=l([]),b=()=>{var e;let l=[];l=l.concat(p.value.getHalfCheckedKeys()),l=l.concat(p.value.getCheckedKeys(!1));const a={roleName:w.value.roleName,isShow:w.value.isShow,rules:l};null==(e=h.value)||e.validate((e=>{e&&v("addRole",a)}))},y=()=>{var e,l;let a=[];a=a.concat(p.value.getHalfCheckedKeys()),a=a.concat(p.value.getCheckedKeys(!1));const t={id:null==(e=m.showRole)?void 0:e.id,roleName:w.value.roleName,isShow:w.value.isShow,rules:a};null==(l=h.value)||l.validate((e=>{e&&v("updateRole",t)}))},k=()=>{v("cancel")};return a((()=>{var e,l,a;"edit"===m.status&&(w.value.roleName=(null==(e=m.showRole)?void 0:e.roleName)||"",w.value.isShow=(null==(l=m.showRole)?void 0:l.isShow)||0,_.value=(null==(a=m.showRole)?void 0:a.rules)||[],_.value.forEach((e=>{const l=p.value.getNode(e);l.isLeaf&&p.value.setChecked(l,!0,!1)})))})),(l,a)=>{const v=t("el-input"),m=t("el-form-item"),_=t("el-switch"),N=t("el-button"),V=t("el-form");return o(),u("div",C,[s(V,{ref_key:"ruleFormRef",ref:h,model:w.value,"label-width":"120px"},{default:d((()=>[s(m,{label:"角色名称",prop:"roleName",rules:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},{default:d((()=>[s(v,{modelValue:w.value.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),s(m,{label:"显示",prop:"status"},{default:d((()=>[s(_,{modelValue:w.value.isShow,"onUpdate:modelValue":a[1]||(a[1]=e=>w.value.isShow=e),class:"ml-2","active-value":0,"inactive-value":1},null,8,["modelValue"])])),_:1}),s(m,null,{default:d((()=>[s(r(i),{data:e.treeList,ref_key:"treeRef",ref:p,props:f,"node-key":"id","show-checkbox":""},null,8,["data"])])),_:1}),s(m,null,{default:d((()=>["add"===e.status?(o(),n(N,{key:0,type:"primary",onClick:b},{default:d((()=>[R])),_:1})):c("",!0),"edit"===e.status?(o(),n(N,{key:1,type:"primary",onClick:y},{default:d((()=>[g])),_:1})):c("",!0),s(N,{onClick:k},{default:d((()=>[S])),_:1})])),_:1})])),_:1},8,["model"])])}}}),L={class:"app-container"},x={class:"flex mb-20"},K=v("查询"),U=v("重置"),j=v("添加角色"),T=v("编辑"),E=e({__name:"role",setup(e){const i=m(["显示","不显示"]),C=l([]),R=l(""),g=l(!1),S=l({id:0,label:"",children:[]}),E=l("add"),H=l({id:0,roleName:"",isShow:0,rules:[]}),q=()=>{b(R.value).then((e=>{C.value=e.data}))},z=()=>{b(void 0).then((e=>{C.value=e.data}))},A=()=>{R.value=""},B=e=>{const l={roleName:e.roleName,isShow:e.isShow,rules:e.rules};y(l).then((e=>{"添加成功"===e.data&&(w.success(e.data),g.value=!1,z())}))},D=e=>{console.log("data========>",e),k(e).then((e=>{"修改成功"===e.data&&(w.success(e.data),g.value=!1,z())}))},F=()=>{g.value=!1},J=()=>{E.value="add",g.value=!0};return a((()=>{z(),_().then((e=>{S.value=e.data}))})),(e,l)=>{const a=t("el-input"),m=t("el-button"),w=t("el-table-column"),_=t("el-tag"),b=t("el-table"),y=t("el-dialog");return o(),u("div",L,[p("div",x,[s(a,{modelValue:R.value,"onUpdate:modelValue":l[0]||(l[0]=e=>R.value=e),placeholder:"请输入用户名称",clearable:"",class:"w-300"},null,8,["modelValue"]),s(m,{class:"ml-10",type:"primary",plain:"",onClick:q},{default:d((()=>[K])),_:1}),s(m,{class:"ml-10",icon:r(h),onClick:A},{default:d((()=>[U])),_:1},8,["icon"])]),s(m,{type:"primary",class:"mb-20",onClick:J},{default:d((()=>[j])),_:1}),s(b,{data:C.value,border:"",style:{width:"100%"}},{default:d((()=>[s(w,{prop:"roleName",label:"角色昵称"}),s(w,{prop:"status",label:"状态"},{default:d((e=>[s(_,{type:0==e.row.status?"success":"danger"},{default:d((()=>[v(f(i[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),s(w,{prop:"createTime",label:"创建时间"},{default:d((e=>[v(f(r(N)(e.row.createTime)),1)])),_:1}),s(w,{prop:"updateTime",label:"更新时间"},{default:d((e=>[v(f(r(N)(e.row.updateTime)),1)])),_:1}),s(w,{prop:"edit",label:"编辑"},{default:d((e=>[s(m,{link:"",type:"primary",size:"small",onClick:l=>(e=>{E.value="edit",g.value=!0;const l={id:e.id,roleName:e.roleName,isShow:e.status,rules:e.rules};H.value=l})(e.row)},{default:d((()=>[T])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),s(y,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=e=>g.value=e),title:"add"===E.value?"添加角色":"修改角色",width:"30%",center:""},{default:d((()=>[g.value&&"add"===E.value?(o(),n(V,{key:0,onAddRole:B,onCancel:F,treeList:S.value,status:E.value},null,8,["treeList","status"])):c("",!0),g.value&&"edit"===E.value?(o(),n(V,{key:1,showRole:H.value,onUpdateRole:D,onCancel:F,treeList:S.value,status:E.value},null,8,["showRole","treeList","status"])):c("",!0)])),_:1},8,["modelValue","title"])])}}});export{E as default};
