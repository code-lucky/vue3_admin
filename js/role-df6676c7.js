import{d as e,r as l,o as a,g as t,h as o,c as s,f as u,w as d,B as r,J as i,i as n,A as c,j as v,a as m,e as p,K as h,z as f,E as w,I as _}from"./index-9d9c798a.js";import{g as y,a as b,u as k}from"./role-f3166953.js";import{f as N}from"./index-4742ef83.js";const C={class:"continer"},R=v("新增"),S=v("更新"),V=v("取消"),g=e({__name:"role-model",props:{treeList:null,status:null,showRole:null},emits:["addRole","cancel","updateRole"],setup(e,{emit:v}){const m=e,p=l(),h={children:"children",label:"label"},f=l({roleName:"",isShow:0}),w=l([]),_=()=>{let e=[];e=e.concat(p.value.getHalfCheckedKeys()),e=e.concat(p.value.getCheckedKeys(!1));const l={roleName:f.value.roleName,isShow:f.value.isShow,rules:e};v("addRole",l)},y=()=>{var e;let l=[];l=l.concat(p.value.getHalfCheckedKeys()),l=l.concat(p.value.getCheckedKeys(!1));const a={id:null==(e=m.showRole)?void 0:e.id,roleName:f.value.roleName,isShow:f.value.isShow,rules:l};v("updateRole",a)},b=()=>{v("cancel")};return a((()=>{var e,l,a;"edit"===m.status&&(f.value.roleName=(null==(e=m.showRole)?void 0:e.roleName)||"",f.value.isShow=(null==(l=m.showRole)?void 0:l.isShow)||0,w.value=(null==(a=m.showRole)?void 0:a.rules)||[],w.value.forEach((e=>{const l=p.value.getNode(e);l.isLeaf&&p.value.setChecked(l,!0,!1)})))})),(l,a)=>{const v=t("el-input"),m=t("el-form-item"),w=t("el-switch"),k=t("el-button"),N=t("el-form");return o(),s("div",C,[u(N,{model:f.value,"label-width":"120px"},{default:d((()=>[u(m,{label:"角色名称",prop:"roleName"},{default:d((()=>[u(v,{modelValue:f.value.roleName,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value.roleName=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),u(m,{label:"显示",prop:"status"},{default:d((()=>[u(w,{modelValue:f.value.isShow,"onUpdate:modelValue":a[1]||(a[1]=e=>f.value.isShow=e),class:"ml-2","active-value":0,"inactive-value":1},null,8,["modelValue"])])),_:1}),u(m,null,{default:d((()=>[u(r(i),{data:e.treeList,ref_key:"treeRef",ref:p,props:h,"node-key":"id","show-checkbox":""},null,8,["data"])])),_:1}),u(m,null,{default:d((()=>["add"===e.status?(o(),n(k,{key:0,type:"primary",onClick:_},{default:d((()=>[R])),_:1})):c("",!0),"edit"===e.status?(o(),n(k,{key:1,type:"primary",onClick:y},{default:d((()=>[S])),_:1})):c("",!0),u(k,{onClick:b},{default:d((()=>[V])),_:1})])),_:1})])),_:1},8,["model"])])}}}),L={class:"app-container"},x={class:"flex mb-20"},K=v("查询"),U=v("重置"),j=v("添加角色"),T=v("编辑"),z=e({__name:"role",setup(e){const i=m(["显示","不显示"]),C=l([]),R=l(""),S=l(!1),V=l({id:0,label:"",children:[]}),z=l("add"),A=l({id:0,roleName:"",isShow:0,rules:[]}),E=()=>{y(R.value).then((e=>{C.value=e.data}))},H=()=>{R.value=""},B=e=>{const l={roleName:e.roleName,isShow:e.isShow,rules:e.rules};b(l).then((e=>{"添加成功"===e.data&&(w.success(e.data),S.value=!1,window.location.reload())}))},I=e=>{console.log("data========>",e),k(e).then((e=>{"修改成功"===e.data&&(w.success(e.data),S.value=!1,window.location.reload())}))},J=()=>{S.value=!1},q=()=>{z.value="add",S.value=!0};return a((()=>{y(void 0).then((e=>{C.value=e.data})),_().then((e=>{V.value=e.data}))})),(e,l)=>{const a=t("el-input"),m=t("el-button"),w=t("el-table-column"),_=t("el-tag"),y=t("el-table"),b=t("el-dialog");return o(),s("div",L,[p("div",x,[u(a,{modelValue:R.value,"onUpdate:modelValue":l[0]||(l[0]=e=>R.value=e),placeholder:"请输入用户名称",clearable:"",class:"w-300"},null,8,["modelValue"]),u(m,{class:"ml-10",type:"primary",plain:"",onClick:E},{default:d((()=>[K])),_:1}),u(m,{class:"ml-10",icon:r(h),onClick:H},{default:d((()=>[U])),_:1},8,["icon"])]),u(m,{type:"primary",class:"mb-20",onClick:q},{default:d((()=>[j])),_:1}),u(y,{data:C.value,border:"",style:{width:"100%"}},{default:d((()=>[u(w,{prop:"id",label:"用户编号"}),u(w,{prop:"roleName",label:"角色昵称"}),u(w,{prop:"status",label:"状态"},{default:d((e=>[u(_,{type:0==e.row.status?"success":"danger"},{default:d((()=>[v(f(i[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),u(w,{prop:"createTime",label:"创建时间"},{default:d((e=>[v(f(r(N)(e.row.createTime)),1)])),_:1}),u(w,{prop:"updateTime",label:"更新时间"},{default:d((e=>[v(f(r(N)(e.row.updateTime)),1)])),_:1}),u(w,{prop:"edit",label:"编辑"},{default:d((e=>[u(m,{link:"",type:"primary",size:"small",onClick:l=>(e=>{z.value="edit",S.value=!0;const l={id:e.id,roleName:e.roleName,isShow:e.status,rules:e.rules};A.value=l})(e.row)},{default:d((()=>[T])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),u(b,{modelValue:S.value,"onUpdate:modelValue":l[1]||(l[1]=e=>S.value=e),title:"add"===z.value?"添加角色":"修改角色",width:"30%",center:""},{default:d((()=>[S.value&&"add"===z.value?(o(),n(g,{key:0,onAddRole:B,onCancel:J,treeList:V.value,status:z.value},null,8,["treeList","status"])):c("",!0),S.value&&"edit"===z.value?(o(),n(g,{key:1,showRole:A.value,onUpdateRole:I,onCancel:J,treeList:V.value,status:z.value},null,8,["showRole","treeList","status"])):c("",!0)])),_:1},8,["modelValue","title"])])}}});export{z as default};
